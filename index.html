<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="theme-color" content="#ffffff" />
    <title>Music Streaming</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Apply theme immediately to prevent flash -->
    <script>
      (function() {
        var theme = localStorage.getItem('app-theme') || 'system';
        var isDark = false;
        
        if (theme === 'dark') {
          isDark = true;
        } else if (theme === 'system') {
          // Check Telegram theme first
          if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.colorScheme) {
            isDark = window.Telegram.WebApp.colorScheme === 'dark';
          } else if (window.matchMedia) {
            isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          }
        }
        
        var root = document.documentElement;
        root.setAttribute('data-theme', isDark ? 'dark' : 'light');
        
        // Apply CSS variables
        if (isDark) {
          root.style.setProperty('--tg-theme-bg-color', '#212121', 'important');
          root.style.setProperty('--tg-theme-text-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-hint-color', '#aaaaaa', 'important');
          root.style.setProperty('--tg-theme-link-color', '#64b5f6', 'important');
          root.style.setProperty('--tg-theme-button-color', '#5288c1', 'important');
          root.style.setProperty('--tg-theme-button-text-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-secondary-bg-color', '#0d0d0d', 'important');
          root.style.setProperty('--tg-theme-header-bg-color', '#212121', 'important');
          root.style.setProperty('--tg-theme-accent-text-color', '#64b5f6', 'important');
          root.style.setProperty('--tg-theme-section-bg-color', '#181818', 'important');
          root.style.setProperty('--tg-theme-section-header-text-color', '#aaaaaa', 'important');
          root.style.setProperty('--tg-theme-subtitle-text-color', '#aaaaaa', 'important');
          root.style.setProperty('--tg-theme-destructive-text-color', '#ff6b6b', 'important');
          document.querySelector('meta[name="theme-color"]').content = '#212121';
        } else {
          root.style.setProperty('--tg-theme-bg-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-text-color', '#000000', 'important');
          root.style.setProperty('--tg-theme-hint-color', '#999999', 'important');
          root.style.setProperty('--tg-theme-link-color', '#2481cc', 'important');
          root.style.setProperty('--tg-theme-button-color', '#2481cc', 'important');
          root.style.setProperty('--tg-theme-button-text-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-secondary-bg-color', '#f0f0f0', 'important');
          root.style.setProperty('--tg-theme-header-bg-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-accent-text-color', '#2481cc', 'important');
          root.style.setProperty('--tg-theme-section-bg-color', '#ffffff', 'important');
          root.style.setProperty('--tg-theme-section-header-text-color', '#999999', 'important');
          root.style.setProperty('--tg-theme-subtitle-text-color', '#999999', 'important');
          root.style.setProperty('--tg-theme-destructive-text-color', '#ff3b30', 'important');
        }
      })();
    </script>
    
    <style>
      /* Prevent white flash on dark theme */
      html[data-theme="dark"] body {
        background-color: #212121;
        color: #ffffff;
      }
      html[data-theme="light"] body {
        background-color: #ffffff;
        color: #000000;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
